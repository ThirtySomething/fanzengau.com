<!DOCTYPE html>
<!--
  Special syntaxes:
  $$blah blah$$
    Mathjax for latex math formulae.
  \(blah blah\)
    Mathjax for latex inline math expressions.
-->
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Compute Normal Distrubution from Scratch by Integration</title>
  <link rel="stylesheet" type="text/css" href="/css/default.css">
  <link rel="stylesheet" type="text/css" href="/css/fanzengau.css">
  <link rel="stylesheet" type="text/css" href="/css/share_on_social_media.css">
  <link rel="stylesheet" type="text/css" href="/css/atelier-dune-light.css">
  <script type="text/javascript" src="/vendor/scripts/jquery.min.js"></script>
  <script type="text/javascript" src="/scripts/index.js"></script>
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async>
  </script>
  <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
</head>
<body>
<div id="main_frame_header"></div>
<div id="content">
    <script type="text/javascript" src="/scripts/index.js"></script>

  <div id="side_panels"></div>
  <div class="column_uneven_2_6_3_center">
    <div class="section">
      <h2>
        Compute Normal Distrubution from Scratch by Integration  
      </h2>
    </div>
    <div class="section">
      <h3>Cumulative distribution function</h3>
      <p>
         The normal distribution cumulative distribution function (cdf): 
         $$ \Phi(x) = \frac{1}{2}(1+erf(\frac{x-\mu}{\sigma\sqrt{2}})) $$
         where \(erf(\cdot)\) is the error function: 
         $$ erf(z) = \frac{2}{\sqrt{\pi}}\int_{0}^{z}e^{-x^2}dx $$
      </p>
      <p>
        \(Phi(x)\) is the cumulative probablity of the normal-distributed random variable being less than \(x\), to calculate such value for a given \(x\), we need to evaluate the error function \(erf(x)\) for that \(x\), which can be performed using numercial integration.
      </p>
    </div>
    <div class="section">
      <pre class="prettyprint linenums">
      import java.io.*;
      import java.util.*;
      import java.text.*;
      import java.math.*;
      import java.util.regex.*;

      public class Solution {

          public static void main(String[] args) {
              double mean = 205*49;
              double std = 15*7;

              System.out.printf("%.4f\n", phi(9800.0, mean, std));
          }
          static double phi(double x, double mean, double std) {
              return 0.5*(1 + erf((x-mean)/std/Math.sqrt(2)));
          }
          
          static double erf(double z) {
              double integral = 0;
              double x = 0;
              double dx = 0.00001;
              while(Math.abs(x) <= Math.abs(z)) {
                  if(z > 0) {
                      integral += Math.exp(-x*x)*dx;
                      x += dx;
                  } else {
                      integral -= Math.exp(-x*x)*dx;
                      x -= dx;
                  }
              }
              System.out.printf("erf(" + z + ") = %.3f\n", 2.0/Math.sqrt(Math.PI)*integral);
              return 2.0/Math.sqrt(Math.PI)*integral;
          }
      }
      </pre>
    </div>
    <div class="section">
    <h3>The quantile function</h3>
    <p>
      The inverse of the cumulative distribution function, \(F(\cdot)=\Phi^{-1}(\cdot)\), is called the <em>quantile function</em>, which is useful in <em>hypothesis testing</em> and <em>confidence interval</em> calculations. We can simply solve for \(x\) using the expression of , to obtain the inverse function $$ F(p)=\sqrt{2}\sigma \cdot erf^{-1}(2p-1)+\mu $$
      By definition, \(F(p)\) is value for which there is \(p\) chance that the random variable takes a value below it.
    </p>
    <p>
      It follows that the probability that the random varible takes a value above \(F(p)\) is \(1-p\). By symmetry of the normal distribution probability distribution function, the probability that the random varible takes a value below \(\mu-F(p)\) is also \(1-p\).
    </p>
    <p>
      The \(F(p)\) for a standard normal distribution is often denoted as \(z_{p}\), since we know the mean and standard deviation for such a distribution is 0 and 1, we can plug them in and get $$ z_{p}(p)=\sqrt{2}\cdot erf^{-1}(2p-1) $$
    </p>
    <p>
      Now there is only one independent variable in \(z_{p}\), and we know it ranges from \([0, 1]\), so a plot can be generated by plugging in every value from 0 to 1 to the equation above.
    </p>
    </div>

    <div id="center_column_footer"></div>
  </div>
  <script> 
  $(function(){
    $("#main_frame_header").load("/include/main_frame_header.html"); 
    $("#side_panels").load("/include/side_panels.html");
    $("#center_column_footer").load("/include/center_column_footer.html"); 
  });
  </script> 
</div>

</body>
</html>